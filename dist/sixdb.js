/*!
 * @author       Juan Jose Capellan <soycape@hotmail.com>
 * @copyright    2018 Juan Jose Capellan
 * @license      {@link https://github.com/jjcapellan/SIXDB/blob/master/LICENSE | MIT license}
 */!function(e){var r={};function n(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=r,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,r){if(1&r&&(e=n(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)n.d(t,o,function(r){return e[r]}.bind(null,o));return t},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="",n(n.s=0)}([function(e,r,n){"use strict";n.r(r);var t={init:function(){this.blockRgx=/\(.*?(?=\))/g,this.blockOperatorRgx=/[\&\|]+(?=(\s*\())/g,this.operatorRgx=/(=|>|<|>=|<=|!=|<>|\^|\$|~~)+/g,this.rightOperandRgx=/(?:([=><\^\$~]))\s*["']?[^"']+["']?\s*(?=[&\|])|(?:[=><\^\$~])\s*["']?[^"']+["']?(?=$)/g,this.leftOperandRgx=/([^"'\s])(\w+)(?=\s*[=|>|<|!|\^|\$~])/g},makeConditionsBlocksArray:function(e){var r=this,n=[],t=e.match(r.blockRgx),o=e.match(r.blockOperatorRgx)?e.match(r.blockOperatorRgx):null;if(!t)return r.pushConditionBlockToArray(e,null,n),n;r.deleteLeftParentheses(t),o&&(o="&"==o||"&&"==o?"and":"or");for(var a=0;a<t.length;a++)r.pushConditionBlockToArray(t[a],o,n);return n},deleteLeftParentheses:function(e){for(var r=e.length,n=0;n<r;n++)e[n]=e[n].substr(1)},pushConditionBlockToArray:function(e,r,n){for(var t=this,o=e.match(t.leftOperandRgx),a=e.match(t.rightOperandRgx),c=0;c<a.length;c++){for(;a[c][0].match(/[=><!\^\$~]/g);)a[c]=a[c].substr(1);a[c]=a[c].replace(/["']/g,"").trim()}for(var s=0;s<a.length;s++)e=e.replace(a[s],"");var u=e.match(t.operatorRgx),i=[];if(1==o.length)i.push({keyPath:o[0],cond:u[0],value:a[0]}),n.push({conditionsArray:i,internalLogOperator:null,externalLogOperator:r}),i=null;else{var l=e.match(/[\&\|]+/g)[0];l="&"==l||"&&"==l?"and":"or";for(var d=0;d<u.length;d++)i.push({keyPath:o[d],cond:u[d],value:a[d]});n.push({conditionsArray:i,internalLogOperator:l,externalLogOperator:r}),i=null}},testConditionBlock:function(e,r,n){for(var t="and"==n||!n,o=0;o<r.length;o++){if(t=this.testCondition(e.value[r[o].keyPath],r[o].cond,r[o].value),!("and"!=n&&n||t))return!1;if("or"==n&&t)return!0}return t},testCondition:function(e,r,n){var t;switch(r){case"=":t=e==n;break;case">":t=e>n;break;case"<":t=e<n;break;case">=":t=e>=n;break;case"<=":t=e<=n;break;case"!=":t=e!=n;break;case"<>":if("string"!=typeof e)return!1;t=-1!=e.indexOf(n);break;case"^":if("string"!=typeof e)return!1;t=0==e.indexOf(n);break;case"$":if("string"!=typeof e)return!1;t=e.indexOf(n)==e.length-n.length;break;case"~~":try{t=ie(e,n)}catch(e){t=!1}}return t}},o={begin:"//---------------------------------------\x3e"};function a(e,r){se&&!r||(r?console.error(e):console.log(e))}var c=!0,s=[];function u(){if(0==s.length)return c=!0,void a("No pending tasks");c=!1;var e=s[0];e.type?(a("Custom task"+o.begin),e.fn.apply(e.context,e.args),i()):e.fn.apply(this,e.args)}function i(){s.shift(),u()}function l(){c&&u()}var d={};function f(e,r){var n={};return r&&(n.type=r.name,n.origin=e,n.description=r.message),d=n,!0}var g=t,v={};function p(e,r,n){f(e,r),s.shift(),ce.close(),n(d),a(d,!0)}function b(e){e.value[v.property]&&(v.counter++,v.actualValue=v.aggregatefn(v.actualValue,e.value[v.property],v.counter))}function k(){a("Result of ".concat(v.origin,' on property "').concat(v.property,'": ').concat(v.actualValue))}function y(e){v=e}function h(e,r,n,t){n(e,r),ce.close(),a(t),i()}function C(e,r,n){ce.close(),f(e,r),a(d,!0),s.shift(),n(d),u()}function x(e,r,n){var t=null;try{t=r.getAll()}catch(r){return p(e,r,n),null}return t}function m(e,r,n){var t=null;try{t=r.openCursor()}catch(r){return p(e,r,n),null}return t}function S(e){e?(function(e,r,n){var t=!1,o=0,a=e.length;for(o=0;o<a;o++){var c=e[o].conditionsArray,s=e[o].internalLogOperator;if((t=g.testConditionBlock(n,c,s))==r)break}return t}(v.conditionsBlocksArray,v.exitsInFirstTrue,e)&&v.cursorFunction(e),e.continue()):(v.successCallback(v.event,v.origin,v.query),ce.close(),v.logFunction(),i())}function O(e){v.resultFiltered.push(e.value),v.counter++}function w(e){e.delete(),v.counter++}function A(){v.counter++}function F(e){for(var r=e.value,n=0,t=v.newObjectValuesSize;n<t;n++)r[v.keys[n]]="function"==typeof v.objectValues[v.keys[n]]?v.objectValues[v.keys[n]](r[v.keys[n]]):v.objectValues[v.keys[n]];e.update(r),v.counter++}function j(){a('Processed query finished: "'.concat(v.query,'"\n ').concat(v.counter,' records counted from the query to: "').concat(v.source,'"'))}function B(){a('Processed query: "'.concat(v.query,'" finished\n ').concat(v.counter,' records returned from object store "').concat(v.source,'"'))}function q(e,r,n,t){var o=null;try{o=r.getAll(n)}catch(r){return p(e,r,t),null}return o}function I(e){var r=!1;return e&&(r="number"==typeof e||!e.match(g.operatorRgx)),r}function N(e,r){var n=m(v.origin,e,r);n?(n.onsuccess=function(e){S(e.target.result)},n.onerror=function(){C(origin,n.error,r)}):u()}var P=null,T=t;function R(e,r,n){P=null;try{var t=ce.transaction(e,n).objectStore(e);P=t.index(r)}catch(e){f("initIndex()",e),a(d,!0)}i()}function L(e,r,n){var t={args:[e,r,n],fn:R};s.push(t)}function D(e,r){var n="Index.getAll()";a(n+o.begin);var t=x(n,P,r);t?(t.onsuccess=function(r){h(r.target.result,n,e,'All records returned from index "'.concat(P.name,'"'))},t.onerror=function(){C(n,t.error,r)}):u()}function V(e,r,n){var t="Index.get()";if(a(t+o.begin),I(e))!function(e,r,n){var t="Index.getByKey()";a(t+o.begin);var c=q(t,P,e,n);if(!c)return void u();c.onsuccess=function(n){r(n.target.result,t,e),ce.close(),a('Records with key "'.concat(e,'" returned from index "').concat(P.name,'"')),i()},c.onerror=function(){C(t,c.error,n)}}(e,r,n);else{var c=[],s=T.makeConditionsBlocksArray(e),l=s?s[0].externalLogOperator:null,d=null!=l&&"and"!=l;y({counter:0,source:P.name,extMode:l,event:c,resultFiltered:c,origin:t,query:e,conditionsBlocksArray:s,exitsInFirstTrue:d,logFunction:B,cursorFunction:O,successCallback:r});var f=m(t,P,n);f?(f.onsuccess=function(e){S(e.target.result)},f.onerror=function(){C(t,f.error,n)}):u()}}function M(e,r,n){if(a("Index.count()"+o.begin),e){var t=T.makeConditionsBlocksArray(e),c=t?t[0].externalLogOperator:null,s=null!=c&&"and"!=c;y({counter:0,get event(){return this.counter},source:P.name,extMode:c,origin:"Index.count()",query:e,conditionsBlocksArray:t,exitsInFirstTrue:s,logFunction:j,cursorFunction:A,successCallback:r}),N(P,n)}else!function(e,r){var n="Index.countAll()";a(n+o.begin);var t=P.count();t.onsuccess=function(r){var t="".concat(r.target.result,' records in index "').concat(P.name,'"');h(r.target.result,n,e,t)},t.onerror=function(){C(n,t.error,r)}}(r,n)}function $(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ue,t=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0,s=c.query,l=c.errorCallback,d=void 0===l?ue:l;a(t+o.begin);var f={origin:t,property:e,aggregatefn:r,successCallback:n,errorCallback:d};s?function(e,r){var n=r.origin,t=r.property,o=r.aggregatefn,a=r.successCallback,c=r.errorCallback;I(e)&&(e=P.keyPath+"="+e);var s=T.makeConditionsBlocksArray(e),i=s?s[0].externalLogOperator:null;y({counter:0,actualValue:null,get event(){return this.actualValue},property:t,aggregatefn:o,extMode:i,origin:n,query:e,conditionsBlocksArray:s,exitsInFirstTrue:null!=i&&"and"!=i,logFunction:k,cursorFunction:b,successCallback:a});var l=m(n,P,c);if(!l)return void u();l.onsuccess=function(e){var r=e.target.result;S(r)},l.onerror=function(){C(n,l.error,c)}}(s,f):function(e){var r=e.origin,n=e.property,t=e.aggregatefn,o=e.successCallback,c=e.errorCallback,s=null,l=0,d=m(r,P,c);if(!d)return void u();d.onsuccess=function(e){var c=e.target.result;c?(c.value[n]&&(l++,s=t(s,c.value[n],l)),c.continue()):(o(s,r),ce.close(),a("Result of ".concat(r,' on property "').concat(n,'": ').concat(s)),i())},d.onerror=function(){C(r,d.error,c)}}(f)}function _(e,r,n){s.push(le),L(e,r,"readonly"),s.push(n)}var K,z=function(e,r){var n=r,t=e;this.name=function(){return n},this.storeName=function(){return t}};z.prototype.getAll=function(e){var r={args:[e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:ue],fn:D};_(this.storeName(),this.name(),r)},z.prototype.get=function(e,r){var n={args:[e,r,arguments.length>2&&void 0!==arguments[2]?arguments[2]:ue],fn:V};_(this.storeName(),this.name(),n)},z.prototype.count=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.query,t=r.errorCallback,o={args:[n,e,void 0===t?ue:t],fn:M};_(this.storeName(),this.name(),o)},z.prototype.aggregateFn=function(e,r,n){var t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o={property:e,successCallback:n,aggregatefn:r,origin:"Index.aggregateFn()",query:t.query,errorCallback:t.errorCallback};s.push(le),L(this.storeName(),this.name(),"readonly"),function(e){var r=e.property,n=e.successCallback,t=[r,e.aggregatefn,n,e.origin,{query:e.query,errorCallback:e.errorCallback}];s.push({args:t,fn:$})}(o)};var J=t;function E(e,r){K=null;try{K=ce.transaction(e,r).objectStore(e)}catch(e){f("initStore()",e),a(d,!0)}i()}function Y(e,r){var n={args:[e,r],fn:E};s.push(n)}function G(e,r,n){var t,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=(c.unique,c.successCallback),u=void 0===s?ue:s,i=c.errorCallback,l=void 0===i?ue:i,d="Store.newIndex()";if(a(d+o.begin),ce.transaction(e).objectStore(e).indexNames.contains(r))return console.log("activated"),void h(null,d,u,'The index "'.concat(r,'" already exists in store "').concat(e,'"'));t=ce.version,ce.close();var f=t+1,g=window.indexedDB.open(ae,f);g.onupgradeneeded=function(r){de(r.target.result);var n=r.target.transaction;try{n.objectStore(e)}catch(e){return void C(d,e,l)}},g.onsuccess=function(n){h(n,d,u,'Index "'.concat(r,'" created in store "').concat(e,'"'))},g.onerror=function(){C(d,g.error,l)}}function H(e,r){var n=r.successCallback,t=void 0===n?ue:n,c=r.errorCallback,s=void 0===c?ue:c;a("Store.add()"+o.begin);var u={obj:e,origin:"Store.add()",successCallback:t,errorCallback:s};Array.isArray(e)?function(e){var r=e.obj,n=e.origin,t=e.successCallback,o=e.errorCallback,a=r.length,c=0,s=function(){var e=K.add(r[c]);c++,e.onerror=function(){C(n,e.error,o)}};for(;c<a;)s();h(event,n,t,'New record/s added to store "'.concat(K.name,'"'))}(u):function(e){var r=e.obj,n=e.origin,t=e.successCallback,o=e.errorCallback,a=K.add(r);a.onsuccess=function(e){h(e,n,t,'New record/s added to store "'.concat(K.name,'"'))},a.onerror=function(e){C(n,e.target.error,o)}}(u)}function Q(e,r){var n=null,t="Store.getAll()";a(t+o.begin);(n=x(t,K,r))?(n.onsuccess=function(r){h(r.target.result,t,e,'All records returned from store "'.concat(K.name,'"'))},n.onerror=function(){C(t,n.error,r)}):u()}function U(e,r,n){var t="Store.get()";if(a(t+o.begin),I(e))!function(e,r,n){var t,c="Store.getByKey()";a(c+o.begin);if(!(t=q(c,K,e,n)))return void u();t.onsuccess=function(n){r(n.target.result,c,e),ce.close(),a('Records with key "'.concat(e,'" returned from store "').concat(K.name,'"')),i()},t.onerror=function(){C(c,t.error,n)}}(e,r,n);else{var c=[],s=J.makeConditionsBlocksArray(e),l=s?s[0].externalLogOperator:null,d=null!=l&&"and"!=l;y({counter:0,source:K.name,extMode:l,event:c,resultFiltered:c,origin:t,query:e,conditionsBlocksArray:s,exitsInFirstTrue:d,logFunction:B,cursorFunction:O,successCallback:r});var f=m(t,K,n);f?(f.onsuccess=function(e){S(e.target.result)},f.onerror=function(){C(t,f.error,n)}):u()}}function W(e,r,n){var t="Store.del()";if(a(t+o.begin),I(e))!function(e,r,n){var t="Store.delByKey()";a(t+o.begin);var c=K.delete(e);c.onsuccess=function(n){r(n,t,e),ce.close(),a('Records with primary key "'.concat(e,'" deleted from store "').concat(K.name,'"')),i()},c.onerror=function(){C(t,c.error,n)}}(e,r,n);else{var c=null,s=J.makeConditionsBlocksArray(e),l=s?s[0].externalLogOperator:null,d=null!=l&&"and"!=l;y({counter:0,extMode:l,source:K.name,event:event,origin:t,query:e,conditionsBlocksArray:s,exitsInFirstTrue:d,logFunction:B,cursorFunction:w,successCallback:r}),(c=m(t,K,n))?(c.onsuccess=function(e){S(e.target.result)},c.onerror=function(){C(t,c.error,n)}):u()}}function X(e,r,n){if(a("Store.count()"+o.begin),e){var t=J.makeConditionsBlocksArray(e),c=t?t[0].externalLogOperator:null,s=null!=c&&"and"!=c;y({counter:0,get event(){return this.counter},source:K.name,extMode:c,origin:"Store.count()",query:e,conditionsBlocksArray:t,exitsInFirstTrue:s,logFunction:j,cursorFunction:A,successCallback:r}),N(K,n)}else!function(e,r){var n="Store.countAll()";a(n+o.begin);var t=K.count();t.onsuccess=function(r){var t="".concat(r.target.result,' records in store "').concat(K.name,'"');h(r.target.result,n,e,t)},t.onerror=function(){C(n,t.error,r)}}(r,n)}function Z(e,r,n,t){var c,s="Store.delIndex()";a(s+o.begin),c=ce.version,ce.close();var u=c+1,i=window.indexedDB.open(ae,u);i.onupgradeneeded=function(n){de(n.target.result);var o=null,a=n.target.transaction;try{o=a.objectStore(e)}catch(e){return void C(s,e,t)}o.deleteIndex(r)},i.onsuccess=function(t){h(t,s,n,'Index "'.concat(r,'" deleted from object store "').concat(e,'"'))},i.onerror=function(){C(s,i.error,t)}}function ee(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ue,t=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0,s=c.query,l=c.errorCallback,d=void 0===l?ue:l;a(t+o.begin);var f={origin:t,property:e,aggregatefn:r,successCallback:n,errorCallback:d};s?function(e,r){var n=r.origin,t=r.property,o=r.aggregatefn,a=r.successCallback,c=r.errorCallback;I(e)&&(e=K.keyPath+"="+e);var s=J.makeConditionsBlocksArray(e),i=s?s[0].externalLogOperator:null;y({counter:0,actualValue:null,get event(){return this.actualValue},property:t,aggregatefn:o,extMode:i,origin:n,query:e,conditionsBlocksArray:s,exitsInFirstTrue:null!=i&&"and"!=i,logFunction:k,cursorFunction:b,successCallback:a});var l=m(n,K,c);if(!l)return void u();l.onsuccess=function(e){var r=e.target.result;S(r)},l.onerror=function(){C(n,l.error,c)}}(s,f):function(e){var r=e.origin,n=e.property,t=e.aggregatefn,o=e.successCallback,c=e.errorCallback,s=null,l=0,d=m(r,K,c);if(!d)return void u();d.onsuccess=function(e){var c=e.target.result;c?(c.value[n]&&(l++,s=t(s,c.value[n],l)),c.continue()):(o(s,r),ce.close(),a("Result of ".concat(r,' on property "').concat(n,'": ').concat(s)),i())},d.onerror=function(){C(r,d.error,c)}}(f)}function re(e,r,n){var t=n.successCallback,c=n.errorCallback;a("Store.update()"+o.begin),I(e)&&(e=K.keyPath+"="+e);var s=J.makeConditionsBlocksArray(e),u=s?s[0].externalLogOperator:null,i=null!=u&&"and"!=u;y({counter:0,keys:Object.keys(r),newObjectValuesSize:Object.keys(r).length,extMode:u,source:K.name,objectValues:r,event:event,origin:"Store.update()",query:e,conditionsBlocksArray:s,exitsInFirstTrue:i,logFunction:B,cursorFunction:F,successCallback:t}),N(K,c)}function ne(e){var r=e.successCallback,n=e.errorCallback,t="Store.clear()";a(t+o.begin);var c=null;try{c=K.clear()}catch(e){return void C(t,c.error,n)}c.onsuccess=function(e){h(e.target.result,t,r,'Store "'.concat(K.name,'" cleared.'))},c.onerror=function(e){C(t,c.error,n)}}function te(e,r,n){s.push(le),Y(e,r),s.push(n)}var oe=function(e){var r=e;this.name=function(){return r}};oe.prototype.newIndex=function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},t=n.unique,o=n.successCallback,a=n.errorCallback,c={args:[this.name(),e,r,{unique:t,successCallback:o,errorCallback:a}],fn:G};s.push(le),s.push(c)},oe.prototype.openIndex=function(e){return new z(this.name(),e)},oe.prototype.add=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={args:[e,{successCallback:r.successCallback,errorCallback:r.errorCallback}],fn:H};te(this.name(),"readwrite",n)},oe.prototype.getAll=function(e){var r={args:[e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:ue],fn:Q};te(this.name(),"readonly",r)},oe.prototype.get=function(e,r){var n={args:[e,r,arguments.length>2&&void 0!==arguments[2]?arguments[2]:ue],fn:U};te(this.name(),"readonly",n)},oe.prototype.del=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.successCallback,t=void 0===n?ue:n,o=r.errorCallback,a={args:[e,t,void 0===o?ue:o],fn:W};te(this.name(),"readwrite",a)},oe.prototype.count=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.query,t=r.errorCallback,o={args:[n,e,void 0===t?ue:t],fn:X};te(this.name(),"readonly",o)},oe.prototype.delIndex=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.successCallback,t=void 0===n?ue:n,o=r.errorCallback,a=void 0===o?ue:o,c={args:[this.name(),e,t,a],fn:Z};s.push(le),s.push(c)},oe.prototype.aggregateFn=function(e,r,n){var t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o={property:e,successCallback:n,aggregatefn:r,origin:"Store.aggregateFn()",query:t.query,errorCallback:t.errorCallback};s.push(le),Y(this.name(),"readonly"),function(e){var r=e.property,n=e.successCallback,t=[r,e.aggregatefn,n,e.origin,{query:e.query,errorCallback:e.errorCallback}];s.push({args:t,fn:ee})}(o)},oe.prototype.update=function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},t=n.successCallback,o=void 0===t?ue:t,a=n.errorCallback,c={args:[e,r,{successCallback:o,errorCallback:void 0===a?ue:a}],fn:re};te(this.name(),"readwrite",c)},oe.prototype.clear=function(e){var r=e.successCallback,n=void 0===r?ue:r,t=e.errorCallback,o={args:[{successCallback:n,errorCallback:void 0===t?ue:t}],fn:ne};te(this.name(),"readwrite",o)},n.d(r,"customOperator",function(){return ie}),n.d(r,"consoleOff",function(){return se}),n.d(r,"db",function(){return ce}),n.d(r,"newStore",function(){return fe}),n.d(r,"dbName",function(){return ae}),n.d(r,"tkOpen",function(){return le}),n.d(r,"setDb",function(){return de}),n.d(r,"voidFn",function(){return ue});
/**
 * @author       Juan Jose Capellan <soycape@hotmail.com>
 * @copyright    2018 Juan Jose Capellan
 * @license      {@link https://github.com/jjcapellan/SIXDB/blob/master/LICENSE | MIT license}
 */
var ae,ce=null,se=!1,ue=function(){return 0},ie=function(e,r){return e==r};var le={args:null,fn:function(){var e=window.indexedDB.open(ae);e.onerror=function(){alert("Error. You must allow web app to use indexedDB.")},e.onsuccess=function(e){ce=e.target.result,i()}}};function de(e){ce=e}function fe(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.keyPath,c=n.autoIncrement,s=n.successCallback,u=n.errorCallback,l="Sixdb.newStore()";if(a(l+o.begin),ce.objectStoreNames.contains(e))return ce.close(),a('Object store "'.concat(e,'" already exists')),void i();r=ce.version,ce.close();var d,f=r+1,g=window.indexedDB.open(ae,f);g.onupgradeneeded=function(r){ce=r.target.result;try{d=ce.createObjectStore(e,{keyPath:t,autoIncrement:c})}catch(e){return void C(l,e,u)}d.onerror=function(e){C(l,e.target.error,u)}},g.onsuccess=function(r){h(r,l,s,'New object store "'.concat(e,'" created'))}}function ge(e,r){var n=r.successCallback,t=r.errorCallback,c="Sixdb.delStore()";a(c+o.begin);var s=ce.version;ce.close();var u=s+1,i=window.indexedDB.open(ae,u);i.onupgradeneeded=function(r){(ce=r.target.result).deleteObjectStore(e)},i.onsuccess=function(r){h(r,c,n,'Object store "'.concat(e,'" deleted'))},i.onerror=function(){C(c,i.error,t)}}function ve(e){var r=e.successCallback,n=e.errorCallback,t="Sixdb.destroy()";a(t+o.begin);var c=window.indexedDB.deleteDatabase(ae);c.onerror=function(){C(t,c.error,n)},c.onsuccess=function(e){r(e,t),a('Database "'.concat(ae,'" deleted')),i()}}function pe(e){var r=e.store1Name,n=e.store2Name,t=e.indexName,c=(e.succesCallback,e.errorCallback,[]),s=[],u=[],i="getJoin()";a(i+o.begin);var l,d,f,g=ce.transaction([r,n]),v=0,p=0,b=g.objectStore(r),k=b.keyPath;b.getAll().onsuccess=function(e){s=e.target.result,d=s.length;var r=g.objectStore(n).index(t);r.getAll().onsuccess=function(e){u=e.target.result,f=u.length,console.log(f),l=r.keyPath,function e(){s[v][k]==u[p][l]?(c.push(Object.assign(u[p],s[v])),p++):v++;v==d||p==f?h(c,i,successCallback,"Join operation completed"):e()}()}}}window.Sixdb=function(e){ae=e;var r,n,c=t;function u(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=window.indexedDB.open(ae);a("Sixdb.newDB()"+o.begin);var r=!1;e.onupgradeneeded=function(){r=!0},e.onsuccess=function(e){e.target.result.close(),a('Database "'.concat(ae,r?'" created':'" already exists')),i()}}this.name,this.setConsoleOff,this.customTask,this.aggregateFuncs,this.execTasks,this.setCustomOperator,this.newStore,this.openStore,this.delStore,this.destroy,c.init(),n={args:[r],fn:u},s.push(n),l()},Sixdb.prototype.name=function(){return ae},Sixdb.prototype.setConsoleOff=function(e){se=e},Sixdb.prototype.customTask=function(e,r,n){var t=[];if(n)for(var o=2,a=arguments.length;o<a;o++)t[2-o]=arguments[o];var c={type:"custom",fn:e,context:r,args:t};s.push(c)},Sixdb.prototype.aggregateFuncs={sum:function(e,r){return e+r},avg:function(e,r,n){return(e*(n-1)+r)/n},max:function(e,r){return r>e?r:e},min:function(e,r,n){return 1==n&&(e=r),r<e&&n>1?r:e}},Sixdb.prototype.setCustomOperator=function(e){e&&"function"==typeof e&&2==e.length&&(ie=e)},Sixdb.prototype.execTasks=function(){l()},Sixdb.prototype.newStore=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={args:[e,{keyPath:r.keyPath,autoIncrement:r.autoIncrement,successCallback:r.successCallback,errorCallback:r.errorCallback}],fn:fe};s.push(le),s.push(n)},Sixdb.prototype.openStore=function(e){return new oe(e)},Sixdb.prototype.delStore=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.successCallback,t=void 0===n?ue:n,o=r.errorCallback,a={args:[e,{successCallback:t,errorCallback:void 0===o?ue:o}],fn:ge};s.push(le),s.push(a)},Sixdb.prototype.destroy=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.successCallback,n=void 0===r?ue:r,t=e.errorCallback,o={args:[{successCallback:n,errorCallback:void 0===t?ue:t}],fn:ve};s.push(o)},Sixdb.prototype.join=function(e){var r=e.store1Name,n=e.store2Name,t=e.indexName,o=e.succesCallback,a=e.errorCallback,c={args:[{store1Name:r,store2Name:n,indexName:t,succesCallback:o,errorCallback:void 0===a?ue:a}],fn:pe};s.push(le),s.push(c)}}]);