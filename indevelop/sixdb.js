!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e||self).sixdb={})}(this,function(e){var r={init:function(){this.blockRgx=/\(.*?(?=\))/g,this.blockOperatorRgx=/[\&\|]+(?=(\s*\())/g,this.operatorRgx=/(=|>|<|>=|<=|!=|<>|\^|\$|~~)+/g,this.rightOperandRgx=/(?:([=><\^\$~]))\s*["']?[^"']+["']?\s*(?=[&\|])|(?:[=><\^\$~])\s*["']?[^"']+["']?(?=$)/g,this.leftOperandRgx=/([^"'\s])(\w+)(?=\s*[=|>|<|!|\^|\$~])/g},makeConditionsBlocksArray:function(e){var r=this,n=[],o=e.match(r.blockRgx),t=e.match(r.blockOperatorRgx)?e.match(r.blockOperatorRgx):null;if(!o)return r.pushConditionBlockToArray(e,null,n),n;r.deleteLeftParentheses(o),t&&(t="&"==t||"&&"==t?"and":"or");for(var a=0;a<o.length;a++)r.pushConditionBlockToArray(o[a],t,n);return n},deleteLeftParentheses:function(e){for(var r=e.length,n=0;n<r;n++)e[n]=e[n].substr(1)},pushConditionBlockToArray:function(e,r,n){for(var o=this,t=e.match(o.leftOperandRgx),a=e.match(o.rightOperandRgx),c=0;c<a.length;c++){for(;a[c][0].match(/[=><!\^\$~]/g);)a[c]=a[c].substr(1);a[c]=a[c].replace(/["']/g,"").trim()}for(var s=0;s<a.length;s++)e=e.replace(a[s],"");var i=e.match(o.operatorRgx),u=[];if(1==t.length)u.push({keyPath:t[0],cond:i[0],value:a[0]}),n.push({conditionsArray:u,internalLogOperator:null,externalLogOperator:r}),u=null;else{var l=e.match(/[\&\|]+/g)[0];l="&"==l||"&&"==l?"and":"or";for(var d=0;d<i.length;d++)u.push({keyPath:t[d],cond:i[d],value:a[d]});n.push({conditionsArray:u,internalLogOperator:l,externalLogOperator:r}),u=null}},testConditionBlock:function(e,r,n){for(var o="and"==n||!n,t=0;t<r.length;t++){if(o=this.testCondition(e.value[r[t].keyPath],r[t].cond,r[t].value),!("and"!=n&&n||o))return!1;if("or"==n&&o)return!0}return o},testCondition:function(e,r,n){var o;switch(r){case"=":o=e==n;break;case">":o=e>n;break;case"<":o=e<n;break;case">=":o=e>=n;break;case"<=":o=e<=n;break;case"!=":o=e!=n;break;case"<>":if("string"!=typeof e)return!1;o=-1!=e.indexOf(n);break;case"^":if("string"!=typeof e)return!1;o=0==e.indexOf(n);break;case"$":if("string"!=typeof e)return!1;o=e.indexOf(n)==e.length-n.length;break;case"~~":try{o=customOperator(e,n)}catch(e){o=!1}}return o}},n=!0,o=[];function t(){if(0==o.length)return n=!0,void u("No pending tasks");n=!1;var e=o[0];e.type?(u("Custom task"+i.begin),e.fn.apply(e.context,e.args),a()):e.fn.apply(this,e.args)}function a(){o.shift(),t()}function c(){n&&t()}var s,i={begin:"//---------------------------------------\x3e"};function u(e,r){consoleOff&&!r||(r?console.error(e):console.log(e))}var l=r;function d(r,n){s=null;try{s=e.db.transaction(r,n).objectStore(r)}catch(r){T("initStore()",r),u(e.lastErrorObj,!0)}a()}function f(e,r){o.push({args:[e,r],fn:d})}function g(r,n,o,t){var a,c=void 0===t?{}:t,s=c.successCallback,l=void 0===s?P:s,d=c.errorCallback,f=void 0===d?P:d,g="Store.newIndex()";if(u(g+i.begin),e.db.transaction(r).objectStore(r).indexNames.contains(n))return console.log("activated"),void Q(null,g,l,'The index "'+n+'" already exists in store "'+r+'"');a=e.db.version,e.db.close();var b=window.indexedDB.open(e.dbName,a+1);b.onupgradeneeded=function(e){V(e.target.result);var t=e.target.transaction;try{t.objectStore(r).createIndex(n,o)}catch(e){return void W(g,e,f)}},b.onsuccess=function(e){Q(e,g,l,'Index "'+n+'" created in store "'+r+'"')},b.onerror=function(){W(g,b.error,f)}}function b(e,r){var n=r.successCallback,o=void 0===n?P:n,t=r.errorCallback,a=void 0===t?P:t,c="Store.add()";u(c+i.begin);var l={obj:e,origin:c,successCallback:o,errorCallback:a};Array.isArray(e)?function(e){for(var r=e.obj,n=e.origin,o=e.successCallback,t=e.errorCallback,a=r.length,c=0,i=function(){var e=s.add(r[c]);c++,e.onerror=function(){W(n,e.error,t)}};c<a;)i();Q(event,n,o,'New record/s added to store "'+s.name+'"')}(l):function(e){var r=e.origin,n=e.successCallback,o=e.errorCallback,t=s.add(e.obj);t.onsuccess=function(e){Q(e,r,n,'New record/s added to store "'+s.name+'"')},t.onerror=function(e){W(r,e.target.error,o)}}(l)}function v(e,r){var n=null,o="Store.getAll()";u(o+i.begin),(n=X(o,s,r))?(n.onsuccess=function(r){Q(r.target.result,o,e,'All records returned from store "'+s.name+'"')},n.onerror=function(){W(o,n.error,r)}):t()}function p(r,n,o){var c="Store.get()";if(u(c+i.begin),ie(r))!function(r,n,o){var c,l="Store.getByKey()";u(l+i.begin),(c=se(l,s,r,o))?(c.onsuccess=function(o){n(o.target.result,l,r),e.db.close(),u('Records with key "'+r+'" returned from store "'+s.name+'"'),a()},c.onerror=function(){W(l,c.error,o)}):t()}(r,n,o);else{var d=[],f=l.makeConditionsBlocksArray(r),g=f?f[0].externalLogOperator:null;H({counter:0,source:s.name,extMode:g,event:d,resultFiltered:d,origin:c,query:r,conditionsBlocksArray:f,exitsInFirstTrue:null!=g&&"and"!=g,logFunction:ce,cursorFunction:re,successCallback:n});var b=Z(c,s,o);b?(b.onsuccess=function(e){ee(e.target.result)},b.onerror=function(){W(c,b.error,o)}):t()}}function k(r,n,o){var c="Store.del()";if(u(c+i.begin),ie(r))!function(r,n,o){var t="Store.delByKey()";u(t+i.begin);var c=s.delete(r);c.onsuccess=function(o){n(o,t,r),e.db.close(),u('Records with primary key "'+r+'" deleted from store "'+s.name+'"'),a()},c.onerror=function(){W(t,c.error,o)}}(r,n,o);else{var d=null,f=l.makeConditionsBlocksArray(r),g=f?f[0].externalLogOperator:null;H({counter:0,extMode:g,source:s.name,event:event,origin:c,query:r,conditionsBlocksArray:f,exitsInFirstTrue:null!=g&&"and"!=g,logFunction:ce,cursorFunction:ne,successCallback:n}),(d=Z(c,s,o))?(d.onsuccess=function(e){ee(e.target.result)},d.onerror=function(){W(c,d.error,o)}):t()}}function y(e,r,n){var o="Store.count()";if(u(o+i.begin),e){var t=l.makeConditionsBlocksArray(e),a=t?t[0].externalLogOperator:null;H({counter:0,get event(){return this.counter},source:s.name,extMode:a,origin:o,query:e,conditionsBlocksArray:t,exitsInFirstTrue:null!=a&&"and"!=a,logFunction:ae,cursorFunction:oe,successCallback:r}),ue(s,n)}else!function(e,r){var n="Store.countAll()";u(n+i.begin);var o=s.count();o.onsuccess=function(r){Q(r.target.result,n,e,r.target.result+' records in store "'+s.name+'"')},o.onerror=function(){W(n,o.error,r)}}(r,n)}function h(r,n,o,t){var a,c="Store.delIndex()";u(c+i.begin),a=e.db.version,e.db.close();var s=window.indexedDB.open(e.dbName,a+1);s.onupgradeneeded=function(e){V(e.target.result);var o=null,a=e.target.transaction;try{o=a.objectStore(r)}catch(e){return void W(c,e,t)}o.deleteIndex(n)},s.onsuccess=function(e){Q(e,c,o,'Index "'+n+'" deleted from object store "'+r+'"')},s.onerror=function(){W(c,s.error,t)}}function C(r,n,o,c,d){void 0===o&&(o=P);var f=d.query,g=d.errorCallback,b=void 0===g?P:g;u(c+i.begin);var v={origin:c,property:r,aggregatefn:n,successCallback:o,errorCallback:b};f?function(e,r){var n=r.origin,o=r.property,a=r.aggregatefn,c=r.successCallback,i=r.errorCallback;ie(e)&&(e=s.keyPath+"="+e);var u=l.makeConditionsBlocksArray(e),d=u?u[0].externalLogOperator:null;H({counter:0,actualValue:null,get event(){return this.actualValue},property:o,aggregatefn:a,extMode:d,origin:n,query:e,conditionsBlocksArray:u,exitsInFirstTrue:null!=d&&"and"!=d,logFunction:_,cursorFunction:Y,successCallback:c});var f=Z(n,s,i);f?(f.onsuccess=function(e){ee(e.target.result)},f.onerror=function(){W(n,f.error,i)}):t()}(f,v):function(r){var n=r.origin,o=r.property,c=r.aggregatefn,i=r.successCallback,l=r.errorCallback,d=null,f=0,g=Z(n,s,l);g?(g.onsuccess=function(r){var t=r.target.result;t?(t.value[o]&&(f++,d=c(d,t.value[o],f)),t.continue()):(i(d,n),e.db.close(),u("Result of "+n+' on property "'+o+'": '+d),a())},g.onerror=function(){W(n,g.error,l)}):t()}(v)}function m(e,r,n){var o=n.successCallback,t=n.errorCallback,a="Store.update()";u(a+i.begin),ie(e)&&(e=s.keyPath+"="+e);var c=l.makeConditionsBlocksArray(e),d=c?c[0].externalLogOperator:null,f=null!=d&&"and"!=d;H({counter:0,keys:Object.keys(r),newObjectValuesSize:Object.keys(r).length,extMode:d,source:s.name,objectValues:r,event:event,origin:a,query:e,conditionsBlocksArray:c,exitsInFirstTrue:f,logFunction:ce,cursorFunction:te,successCallback:o}),ue(s,t)}function x(e){var r=e.successCallback,n=e.errorCallback,o="Store.clear()";u(o+i.begin);var t=null;try{t=s.clear()}catch(e){return void W(o,t.error,n)}t.onsuccess=function(e){Q(e.target.result,o,r,'Store "'+s.name+'" cleared.')},t.onerror=function(e){W(o,t.error,n)}}function S(e,r,n){o.push(D),f(e,r),o.push(n)}var O=function(e){var r=e;this.name=function(){return r}};O.prototype.newIndex=function(e,r,n){var t=void 0===n?{}:n,a=t.unique,c=t.successCallback,s=t.errorCallback,i={args:[this.name(),e,r,{unique:a,successCallback:c,errorCallback:s}],fn:g};o.push(D),o.push(i)},O.prototype.openIndex=function(e){return new R(this.name(),e)},O.prototype.add=function(e,r){var n=void 0===r?{}:r,o={args:[e,{successCallback:n.successCallback,errorCallback:n.errorCallback}],fn:b};S(this.name(),"readwrite",o)},O.prototype.getAll=function(e,r){void 0===r&&(r=P);var n={args:[e,r],fn:v};S(this.name(),"readonly",n)},O.prototype.get=function(e,r,n){void 0===n&&(n=P);var o={args:[e,r,n],fn:p};S(this.name(),"readonly",o)},O.prototype.del=function(e,r){var n=void 0===r?{}:r,o=n.successCallback,t=n.errorCallback,a={args:[e,void 0===o?P:o,void 0===t?P:t],fn:k};S(this.name(),"readwrite",a)},O.prototype.count=function(e,r){var n=void 0===r?{}:r,o=n.errorCallback,t={args:[n.query,e,void 0===o?P:o],fn:y};S(this.name(),"readonly",t)},O.prototype.delIndex=function(e,r){var n=void 0===r?{}:r,t=n.successCallback,a=void 0===t?P:t,c=n.errorCallback,s=void 0===c?P:c,i={args:[this.name(),e,a,s],fn:h};o.push(D),o.push(i)},O.prototype.aggregateFn=function(e,r,n,t){var a,c=void 0===t?{}:t,s={property:e,successCallback:n,aggregatefn:r,origin:"Store.aggregateFn()",query:c.query,errorCallback:c.errorCallback};o.push(D),f(this.name(),"readonly"),o.push({args:[(a=s).property,a.aggregatefn,a.successCallback,a.origin,{query:a.query,errorCallback:a.errorCallback}],fn:C})},O.prototype.update=function(e,r,n){var o=void 0===n?{}:n,t=o.successCallback,a=o.errorCallback,c={args:[e,r,{successCallback:void 0===t?P:t,errorCallback:void 0===a?P:a}],fn:m};S(this.name(),"readwrite",c)},O.prototype.clear=function(e){var r=e.successCallback,n=e.errorCallback,o={args:[{successCallback:void 0===r?P:r,errorCallback:void 0===n?P:n}],fn:x};S(this.name(),"readwrite",o)};var w=null,A=r;function j(r,n,o){w=null;try{var t=e.db.transaction(r,o).objectStore(r);w=t.index(n)}catch(r){T("initIndex()",r),u(e.lastErrorObj,!0)}a()}function B(e,r,n){o.push({args:[e,r,n],fn:j})}function F(e,r){var n="Index.getAll()";u(n+i.begin);var o=X(n,w,r);o?(o.onsuccess=function(r){Q(r.target.result,n,e,'All records returned from index "'+w.name+'"')},o.onerror=function(){W(n,o.error,r)}):t()}function N(r,n,o){var c="Index.get()";if(u(c+i.begin),ie(r))!function(r,n,o){var c="Index.getByKey()";u(c+i.begin);var s=se(c,w,r,o);s?(s.onsuccess=function(o){n(o.target.result,c,r),e.db.close(),u('Records with key "'+r+'" returned from index "'+w.name+'"'),a()},s.onerror=function(){W(c,s.error,o)}):t()}(r,n,o);else{var s=[],l=A.makeConditionsBlocksArray(r),d=l?l[0].externalLogOperator:null;H({counter:0,source:w.name,extMode:d,event:s,resultFiltered:s,origin:c,query:r,conditionsBlocksArray:l,exitsInFirstTrue:null!=d&&"and"!=d,logFunction:ce,cursorFunction:re,successCallback:n});var f=Z(c,w,o);f?(f.onsuccess=function(e){ee(e.target.result)},f.onerror=function(){W(c,f.error,o)}):t()}}function q(e,r,n){var o="Index.count()";if(u(o+i.begin),e){var t=A.makeConditionsBlocksArray(e),a=t?t[0].externalLogOperator:null;H({counter:0,get event(){return this.counter},source:w.name,extMode:a,origin:o,query:e,conditionsBlocksArray:t,exitsInFirstTrue:null!=a&&"and"!=a,logFunction:ae,cursorFunction:oe,successCallback:r}),ue(w,n)}else!function(e,r){var n="Index.countAll()";u(n+i.begin);var o=w.count();o.onsuccess=function(r){Q(r.target.result,n,e,r.target.result+' records in index "'+w.name+'"')},o.onerror=function(){W(n,o.error,r)}}(r,n)}function I(r,n,o,c,s){void 0===o&&(o=P);var l=s.query,d=s.errorCallback,f=void 0===d?P:d;u(c+i.begin);var g={origin:c,property:r,aggregatefn:n,successCallback:o,errorCallback:f};l?function(e,r){var n=r.origin,o=r.property,a=r.aggregatefn,c=r.successCallback,s=r.errorCallback;ie(e)&&(e=w.keyPath+"="+e);var i=A.makeConditionsBlocksArray(e),u=i?i[0].externalLogOperator:null;H({counter:0,actualValue:null,get event(){return this.actualValue},property:o,aggregatefn:a,extMode:u,origin:n,query:e,conditionsBlocksArray:i,exitsInFirstTrue:null!=u&&"and"!=u,logFunction:_,cursorFunction:Y,successCallback:c});var l=Z(n,w,s);l?(l.onsuccess=function(e){ee(e.target.result)},l.onerror=function(){W(n,l.error,s)}):t()}(l,g):function(r){var n=r.origin,o=r.property,c=r.aggregatefn,s=r.successCallback,i=r.errorCallback,l=null,d=0,f=Z(n,w,i);f?(f.onsuccess=function(r){var t=r.target.result;t?(t.value[o]&&(d++,l=c(l,t.value[o],d)),t.continue()):(s(l,n),e.db.close(),u("Result of "+n+' on property "'+o+'": '+l),a())},f.onerror=function(){W(n,f.error,i)}):t()}(g)}function L(e,r,n){o.push(D),B(e,r,"readonly"),o.push(n)}var R=function(e,r){var n=r,o=e;this.name=function(){return n},this.storeName=function(){return o}};function T(r,n){var o={};return n&&(o.type=n.name,o.origin=r,o.description=n.message),e.lastErrorObj=o,!0}R.prototype.getAll=function(e,r){void 0===r&&(r=P);var n={args:[e,r],fn:F};L(this.storeName(),this.name(),n)},R.prototype.get=function(e,r,n){void 0===n&&(n=P);var o={args:[e,r,n],fn:N};L(this.storeName(),this.name(),o)},R.prototype.count=function(e,r){var n=void 0===r?{}:r,o=n.errorCallback,t={args:[n.query,e,void 0===o?P:o],fn:q};L(this.storeName(),this.name(),t)},R.prototype.aggregateFn=function(e,r,n,t){var a,c=void 0===t?{}:t,s={property:e,successCallback:n,aggregatefn:r,origin:"Index.aggregateFn()",query:c.query,errorCallback:c.errorCallback};o.push(D),B(this.storeName(),this.name(),"readonly"),o.push({args:[(a=s).property,a.aggregatefn,a.successCallback,a.origin,{query:a.query,errorCallback:a.errorCallback}],fn:I})},e.lastErrorObj={},e.db=null,e.dbName=void 0;var P=function(){return 0},D={args:null,fn:function(){var r=window.indexedDB.open(e.dbName);r.onerror=function(){alert("Error. You must allow web app to use indexedDB.")},r.onsuccess=function(r){e.db=r.target.result,a()}}};function V(r){e.db=r}function E(r,n){var o="Sixdb.checkStore()";u(o+i.begin);var t=e.db.objectStoreNames.contains(r);e.db.close(),n(t,o),a()}function M(r,n){var o,t=void 0===n?{}:n,c=t.keyPath,s=t.autoIncrement,l=t.successCallback,d=t.errorCallback,f="Sixdb.newStore()";if(u(f+i.begin),e.db.objectStoreNames.contains(r))return e.db.close(),u('Object store "'+r+'" already exists'),void a();o=e.db.version,e.db.close();var g,b=window.indexedDB.open(e.dbName,o+1);b.onupgradeneeded=function(n){e.db=n.target.result;try{g=e.db.createObjectStore(r,{keyPath:c,autoIncrement:s})}catch(e){return void W(f,e,d)}g.onerror=function(e){W(f,e.target.error,d)}},b.onsuccess=function(e){Q(e,f,l,'New object store "'+r+'" created')}}function $(r,n){var o=n.successCallback,t=n.errorCallback,a="Sixdb.delStore()";u(a+i.begin);var c=e.db.version;e.db.close();var s=window.indexedDB.open(e.dbName,c+1);s.onupgradeneeded=function(n){e.db=n.target.result,e.db.deleteObjectStore(r)},s.onsuccess=function(e){Q(e,a,o,'Object store "'+r+'" deleted')},s.onerror=function(){W(a,s.error,t)}}function K(r){var n=r.successCallback,o=r.errorCallback,t="Sixdb.destroy()";u(t+i.begin);var c=window.indexedDB.deleteDatabase(e.dbName);c.onerror=function(){W(t,c.error,o)},c.onsuccess=function(r){n(r,t),u('Database "'+e.dbName+'" deleted'),a()}}function G(r){var n=r.store1Name,o=r.store2Name,t=r.indexName,a=[],c=[],s=[],l="getJoin()";u(l+i.begin);var d,f,g,b=e.db.transaction([n,o]),v=0,p=0,k=b.objectStore(n),y=k.keyPath;function h(){c[v][y]==s[p][d]?(a.push(Object.assign(s[p],c[v])),p++):v++,v==f||p==g?Q(a,l,successCallback,"Join operation completed"):h()}k.getAll().onsuccess=function(e){f=(c=e.target.result).length;var r=b.objectStore(o).index(t);r.getAll().onsuccess=function(e){g=(s=e.target.result).length,console.log(g),d=r.keyPath,h()}}}window.Sixdb=function(n){e.dbName=n,r.init(),o.push({args:[void 0],fn:function(r){var n=window.indexedDB.open(e.dbName);u("Sixdb.newDB()"+i.begin);var o=!1;n.onupgradeneeded=function(){o=!0},n.onsuccess=function(r){r.target.result.close(),u(o?'Database "'+e.dbName+'" created':'Database "'+e.dbName+'" already exists'),a()}}}),c()},Sixdb.prototype.name=function(){return e.dbName},Sixdb.prototype.setConsoleOff=function(e){consoleOff=e},Sixdb.prototype.customTask=function(e,r,n){var t=[];if(n)for(var a=2,c=arguments.length;a<c;a++)t[2-a]=arguments[a];var s={type:"custom",fn:e,context:r,args:t};o.push(s)},Sixdb.prototype.aggregateFuncs={sum:function(e,r){return e+r},avg:function(e,r,n){return(e*(n-1)+r)/n},max:function(e,r){return r>e?r:e},min:function(e,r,n){return 1==n&&(e=r),r<e&&n>1?r:e}},Sixdb.prototype.setCustomOperator=function(e){e&&"function"==typeof e&&2==e.length&&(customOperator=e)},Sixdb.prototype.execTasks=function(){c()},Sixdb.prototype.checkStore=function(e,r){void 0===r&&(r=P);var n={args:[e,r],fn:E};o.push(D),o.push(n)},Sixdb.prototype.newStore=function(e,r){var n=void 0===r?{}:r,t={args:[e,{keyPath:n.keyPath,autoIncrement:n.autoIncrement,successCallback:n.successCallback,errorCallback:n.errorCallback}],fn:M};o.push(D),o.push(t)},Sixdb.prototype.openStore=function(e){return new O(e)},Sixdb.prototype.delStore=function(e,r){var n=void 0===r?{}:r,t=n.successCallback,a=n.errorCallback,c={args:[e,{successCallback:void 0===t?P:t,errorCallback:void 0===a?P:a}],fn:$};o.push(D),o.push(c)},Sixdb.prototype.destroy=function(e){var r=void 0===e?{}:e,n=r.successCallback,t=r.errorCallback;o.push({args:[{successCallback:void 0===n?P:n,errorCallback:void 0===t?P:t}],fn:K})},Sixdb.prototype.join=function(e){var r=e.errorCallback,n={args:[{store1Name:e.store1Name,store2Name:e.store2Name,indexName:e.indexName,succesCallback:e.succesCallback,errorCallback:void 0===r?P:r}],fn:G};o.push(D),o.push(n)};var z=r,J={};function U(r,n,t){T(r,n),o.shift(),e.db.close(),t(e.lastErrorObj),u(e.lastErrorObj,!0)}function Y(e){e.value[J.property]&&(J.counter++,J.actualValue=J.aggregatefn(J.actualValue,e.value[J.property],J.counter))}function _(){u("Result of "+J.origin+' on property "'+J.property+'": '+J.actualValue)}function H(e){J=e}function Q(r,n,o,t){o(r,n),e.db.close(),u(t),a()}function W(r,n,a){e.db.close(),T(r,n),u(e.lastErrorObj,!0),o.shift(),a(e.lastErrorObj),t()}function X(e,r,n){var o=null;try{o=r.getAll()}catch(r){return U(e,r,n),null}return o}function Z(e,r,n){var o=null;try{o=r.openCursor()}catch(r){return U(e,r,n),null}return o}function ee(r){if(r){var n=function(e,r,n){var o=!1,t=0,a=e.length;for(t=0;t<a&&(o=z.testConditionBlock(n,e[t].conditionsArray,e[t].internalLogOperator))!=r;t++);return o}(J.conditionsBlocksArray,J.exitsInFirstTrue,r);n&&J.cursorFunction(r),r.continue()}else J.successCallback(J.event,J.origin,J.query),e.db.close(),J.logFunction(),a()}function re(e){J.resultFiltered.push(e.value),J.counter++}function ne(e){e.delete(),J.counter++}function oe(){J.counter++}function te(e){for(var r=e.value,n=0,o=J.newObjectValuesSize;n<o;n++)r[J.keys[n]]="function"==typeof J.objectValues[J.keys[n]]?J.objectValues[J.keys[n]](r[J.keys[n]]):J.objectValues[J.keys[n]];e.update(r),J.counter++}function ae(){u('Processed query finished: "'+J.query+'"\n '+J.counter+' records counted from the query to: "'+J.source+'"')}function ce(){u('Processed query: "'+J.query+'" finished\n '+J.counter+' records returned from object store "'+J.source+'"')}function se(e,r,n,o){var t=null;try{t=r.getAll(n)}catch(r){return U(e,r,o),null}return t}function ie(e){var r=!1;return e&&(r="number"==typeof e||!e.match(z.operatorRgx)),r}function ue(e,r){var n=Z(J.origin,e,r);n?(n.onsuccess=function(e){ee(e.target.result)},n.onerror=function(){W(origin,n.error,r)}):t()}window.consoleOff=!1,window.customOperator=function(e,r){return e==r},e.Index=R,e.Store=O,e._qrySys=r,e.aggregateLog=_,e.checkTasks=t,e.countLog=ae,e.cursorAggregate=Y,e.cursorCount=oe,e.cursorDelRecords=ne,e.cursorGetRecords=re,e.cursorLoop=ee,e.cursorUpdate=te,e.done=a,e.execTasks=c,e.initCursorLoop=ue,e.isKey=ie,e.logEnum=i,e.logger=u,e.makeErrorObject=T,e.queryLog=ce,e.requestErrorAction=W,e.requestSuccessAction=Q,e.setDb=V,e.setSharedObj=H,e.tasks=o,e.tkOpen=D,e.tryGetAll=X,e.tryGetByKey=se,e.tryOpenCursor=Z,e.voidFn=P});
//# sourceMappingURL=sixdb.js.map
